FROM python:3-alpine
WORKDIR /flaskapp
ADD . /flaskapp
RUN apk add libmagic \
 && pip install poetry \
 && poetry config virtualenvs.in-project true \
 && poetry install
 # && poetry install --without dev
RUN mkdir -p '/flaskapp/uploads'
EXPOSE 80
CMD [ ".venv/bin/python3", "-m", "gunicorn", "--bind", "0.0.0.0:80", "runner:app" ]